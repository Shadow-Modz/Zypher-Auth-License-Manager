<!doctype html>
<html lang="en">

<head>
	<%- include ("../partials/head") %>
	<title>Zypher - Product</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.min.css" integrity="sha512-O03ntXoVqaGUTAeAmvQ2YSzkCvclZEcPQu1eqloPaHfJ5RuNGiS4l+3duaidD801P50J28EHyonCV06CUlTSag==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
	<script src="/dist/js/demo-theme.min.js?1668287865"></script>
	<div class="page">
		<%- include ("../partials/navbar", { slt: "p" }) %>
			<div class="page-wrapper">
				<div class="page-header d-print-none">
					<div class="container-xl">
						<div class="row g-2 align-items-center">
							<div class="col">
								<h2 class="page-title">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"></path>
										<path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"></path>
										<path d="M16 5l3 3"></path>
								 </svg>
									Edit a Product
								</h2>
							</div>
						</div>
					</div>
				</div>
				
				<div class="page-body">
					<div class="container-xl">
						<fieldset class="form-fieldset">
							<label class="form-label required">Name</label>
							<div class="input-icon mb-3">
								<span class="input-icon-addon">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M12 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"></path>
										<path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
								 </svg>
								</span>
								<input id="name" value="<%= product.name %>" type="text" class="form-control" autocomplete="off">
							</div>

							<label class="form-label required">Description</label>
							<div class="input-icon mb-3">
								<span class="input-icon-addon">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-id" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v10a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z"></path>
										<path d="M9 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"></path>
										<path d="M15 8l2 0"></path>
										<path d="M15 12l2 0"></path>
										<path d="M7 16l10 0"></path>
								 </svg>
								</span>
								<input id="description" value="<%= product.description %>" type="text" class="form-control" autocomplete="off">
							</div>

							<label class="form-label required">Price</label>
							<div class="input-icon mb-3">
								<span class="input-icon-addon">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-currency-dollar" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2"></path>
										<path d="M12 3v3m0 12v3"></path>
								 </svg>
								</span>
								<input id="price" value="<%= product.price.toFixed(2) %>" type="number" class="form-control" autocomplete="off">
							</div>
							
							<label class="form-label required">Version</label>
							<div class="input-icon mb-3">
								<span class="input-icon-addon">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-package" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5"></path>
										<path d="M12 12l8 -4.5"></path>
										<path d="M12 12l0 9"></path>
										<path d="M12 12l-8 -4.5"></path>
										<path d="M16 5.25l-8 4.5"></path>
								 </svg>
								</span>
								<input id="version" value="<%= product.version %>" type="text" class="form-control" autocomplete="off">
							</div>

							<label class="form-label">Customer Role</label>
							<div class="input-icon mb-3">
								<span class="input-icon-addon">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
									   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
									   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
									   <path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
									   <path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855"></path>
									</svg>
								</span>
								<input id="role" value="<%= product.role %>" type="text" class="form-control" autocomplete="off">
							</div>

							<label class="form-label">Created At</label>
							<div class="input-icon mb-3">
								<span class="input-icon-addon">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
										<path d="M16 3l0 4"></path>
										<path d="M8 3l0 4"></path>
										<path d="M4 11l16 0"></path>
										<path d="M11 15l1 0"></path>
										<path d="M12 15l0 3"></path>
								 </svg>
								</span>
								<input value="<%= product.createdAt.toLocaleDateString("en-US", { weekday: "long", year: "numeric", month: "long", day: "numeric" }) %>" type="text" class="form-control" autocomplete="off" readonly>
							</div>

							<div class="text-end">
								<button onclick='updateProduct("<%= product.name %>")' class="btn btn-primary">
									<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
										<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
										<path d="M12 15l8.385 -8.415a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3z"></path>
										<path d="M16 5l3 3"></path>
										<path d="M9 7.07a7 7 0 0 0 1 13.93a7 7 0 0 0 6.929 -6"></path>
								 </svg>
									Update
								</button>
							</div>
						</fieldset>
					</div>
				</div>
				<%- include ("../partials/footer") %>
			</div>
	</div>
	<script>
		async function updateProduct(product) {
			const name = document.getElementById("name").value;
			const description = document.getElementById("description").value;
			const price = document.getElementById("price").value;
			const version = document.getElementById("version").value;
			const role = document.getElementById("role").value;
		
			const productObject = { name, description, price, version, role };

			const res = await fetch(`/api/web/products/${product}`, {
				method: "PATCH",
				body: JSON.stringify(productObject),
				headers: {
					"Content-Type": "application/json"
				}
			});

			const data = await res.json();
			if (res.status !== 200) {
				return iziToast.show({
          title: data?.message || "Something went wrong!",
          color: "red",
          position: "topRight",
          layout: 1,
          icon: "iziToast-icon ico-error revealIn"
        });
			}

			return iziToast.show({
        title: data?.message || "Product updated correctly!",
        color: "green",
        position: "topRight",
        layout: 1,
        icon: "iziToast-icon ico-success revealIn",
        onClosing: () => {
          location.reload()
        }
      });
		}
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.min.js" integrity="sha512-Zq9o+E00xhhR/7vJ49mxFNJ0KQw1E1TMWkPTxrWcnpfEFDEXgUiwJHIKit93EW/XxE31HSI5GEOW06G6BF1AtA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="/dist/js/tabler.min.js?1668287865" defer></script>
	<script src="/dist/js/demo.min.js?1668287865" defer></script>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-5PE1JS9ZWW"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	
	  gtag('config', 'G-5PE1JS9ZWW');
	</script>
</body>

</html>